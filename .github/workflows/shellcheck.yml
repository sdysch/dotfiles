name: ShellCheck

on:
  push:
    paths:
      - 'setups/**/.local/bin/**'
      - 'install_scripts/*.sh'
  pull_request:
    paths:
      - 'setups/**/.local/bin/**'
      - 'install_scripts/*.sh'

jobs:
  shellcheck:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v4

      - name: Run ShellCheck
        run: |
          set -e

          echo 'Running ShellCheckâ€¦'

          find \
            setups/arch/.local/bin \
            setups/common/.local/bin \
            setups/flyr/.local/bin \
            install_scripts \
            -type f \
            \( -name '*.sh' -o -perm -111 \) \
            -print0 |
          xargs -0 shellcheck
