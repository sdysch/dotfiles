#!/bin/bash

# Emoji picker using fzf
# Shows emoji + name, copies only emoji to clipboard

EMOJI_FILE="${XDG_DATA_HOME:-$HOME/.local/share}/emoji_list"

# Ensure emoji file exists
if [ ! -f "$EMOJI_FILE" ]; then
  mkdir -p "$(dirname "$EMOJI_FILE")"
  cat > "$EMOJI_FILE" <<'EOF'
ðŸ˜€ Grinning Face
ðŸ˜‚ Face With Tears of Joy
ðŸ¥° Smiling Face With Hearts
ðŸ˜Ž Smiling Face With Sunglasses
ðŸ¤” Thinking Face
ðŸ™Œ Raising Hands
ðŸŽ‰ Party Popper
ðŸ”¥ Fire
ðŸ’¡ Light Bulb
â¤ï¸ Red Heart
ðŸ‘©â€ðŸ’» Woman Technologist
ðŸ‡©ðŸ‡° Flag: Denmark
EOF
fi

# Ensure fzf is installed
command -v fzf >/dev/null 2>&1 || { echo "fzf not found"; exit 1; }

# Show interactive search
# Display emoji + name, allow search
selected=$(fzf --ansi --prompt="Choose emoji: " --height 40% --reverse < "$EMOJI_FILE")
[ -n "$selected" ] || exit 0

# Extract only the emoji (everything before the first space)
emoji="${selected%% *}"

# Copy to clipboard (cross-platform)
if command -v wl-copy >/dev/null 2>&1; then
    echo -n "$emoji" | wl-copy
elif command -v xclip >/dev/null 2>&1; then
    echo -n "$emoji" | xclip -selection clipboard
elif command -v pbcopy >/dev/null 2>&1; then
    echo -n "$emoji" | pbcopy
else
    echo "No clipboard tool found (wl-copy, xclip, pbcopy)" >&2
    exit 1
fi

# Optional notify
command -v notify-send >/dev/null 2>&1 && notify-send "'$emoji' copied to clipboard." &
