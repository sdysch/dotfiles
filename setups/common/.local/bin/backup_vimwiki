#!/bin/sh
# automatically backup vimwiki

set -eu

[ -d "$VIMWIKI" ] || exit 0

# exit early if nothing changed
git -C "$VIMWIKI" diff --quiet && exit 0

timestamp=$(date -Is)
message="Vimwiki auto-backup @ $timestamp"

git -C "$VIMWIKI" add -A
git -C "$VIMWIKI" commit -m "$message" > /dev/null
git -C "$VIMWIKI" push > /dev/null

notify_info "Vimwiki" "$message"
