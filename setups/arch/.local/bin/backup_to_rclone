#!/bin/bash

# backup_to_rclone.sh
# Usage: backup_to_rclone.sh [docs|music|videos|media|all]
# Defaults to 'all' if no argument given.

# check if already running
pgrep -f backup_to_rclone.sh > /dev/null && { echo "Already running" ; exit; }

notify-send "ðŸ”ƒ Running backup" -t 3000

# config
LOCATION='google_drive:arch_backups'
CMD="rclone sync --exclude-from $HOME/.local/share/rclone_exclude.txt \
  --fast-list \
  --transfers=8 \
  --checkers=16 \
  -v --log-file=$HOME/.local/share/rclone_backup.log"

# which sets to back up
TARGET="${1:-all}"

case "$TARGET" in
  docs)
    $CMD $HOME/Documents $LOCATION/Documents
    ;;
  media)
    $CMD $HOME/Music $LOCATION/Music
    $CMD $HOME/Videos $LOCATION/Videos
    ;;
  music)
    $CMD $HOME/Music $LOCATION/Music
    ;;
  videos)
    $CMD $HOME/Videos $LOCATION/Videos
    ;;
  all)
    $CMD $HOME/Documents $LOCATION/Documents
    $CMD $HOME/Music $LOCATION/Music
    $CMD $HOME/Videos $LOCATION/Videos
    ;;
  *)
    echo "Usage: $0 [docs|media|music|videos|all]"
    exit 1
    ;;
esac

notify-send "âœ… Backup ($TARGET) completed" -t 3000
