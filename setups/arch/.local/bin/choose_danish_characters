#!/bin/bash

# "get a menu of Danish characters to copy" script

# Must have xclip installed
xclip -h 2>/dev/null || exit 1

# File with Danish characters
CHAR_FILE="${XDG_DATA_HOME:-$HOME/.local/share}/danish_characters"

# Determine menu program
MENU_PROGRAM="dmenu"
MENU_ARGS="-fn 'xos4 Terminus:size=12' -sb '#A3BE8C' -nb '#2E3440' -nf '#D8DEE9' -sf '#434C5E' -p 'Choose a character' -l 7"

# Use rofi if -r is passed
if [ "$1" = "-r" ]; then
    MENU_PROGRAM="rofi"
    MENU_ARGS="-dmenu -i -p 'Choose a character'"
fi

# Show menu
chosen=$(cut -d ';' -f1 "$CHAR_FILE" | $MENU_PROGRAM $MENU_ARGS)

# Exit if nothing chosen
[ -n "$chosen" ] || exit 0

# Copy to clipboard (cross-platform)
if command -v wl-copy >/dev/null 2>&1; then
    echo -n "$chosen" | wl-copy
elif command -v xclip >/dev/null 2>&1; then
    echo -n "$chosen" | xclip -selection clipboard
elif command -v pbcopy >/dev/null 2>&1; then
    echo -n "$chosen" | pbcopy
else
    echo "No clipboard tool found (wl-copy, xclip, pbcopy)" >&2
    exit 1
fi

# Notify
notify-send -i dialog-information "Info" "'$chosen' copied to clipboard." &
