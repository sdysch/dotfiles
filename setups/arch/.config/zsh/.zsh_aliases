# personal aliases
# === helpers ===
_require_cmd() {
  command -v "$1" >/dev/null 2>&1 && return 0
  _err "Missing required command: $1"
  return 1
}

_err() {
  printf '\n\033[1;31m==> ERROR: %s\033[0m\n' "$1" >&2
}

# opening files
open() {
	xdg-open "$@" 2>/dev/null & 
}

# gnu pass
alias pgp="pass git push origin master"

# pacman
alias p="sudo pacman"

# mounting storage drive, I always forget this. # TODO check location in function
alias mount_seagate="sudo mount -t ntfs-3g /dev/sda1 /mnt"

# count songs in mpd database
function number_of_songs() {
	_require_cmd mpc || return 1
	mpc update >/dev/null 2>&1
	mpc stats | awk -F': ' '/Songs:/ {print $2}'
}

# check music metadata in a directory
function check_music_metadata() {
	shopt -s nullglob
	for f in "$@"; do
		echo "File: $f"
		ffprobe -v error \
		  -show_entries format_tags=title,album,artist \
		  -of default=noprint_wrappers=1:nokey=0 "$f"
		echo
	done
}

# music
function ytmp3() {
	_require_cmd yt-dlp || return 1
	yt-dlp -o '%(playlist_index)s - %(title)s.%(ext)s' \
			 --extract-audio \
			 --audio-format mp3 \
			 --add-metadata \
			 --embed-thumbnail \
			 --metadata-from-title "%(artist)s - %(title)s" \
			 --split-chapters \
			 "$1"
}

function update_pacman_mirrors() {
	_require_cmd reflector || return 1
	sudo reflector --latest 10 --sort rate --country "united kingdom" --protocol http,https --save /etc/pacman.d/mirrorlist
}

# === mail ===
alias mbsync="mbsync -c $XDG_CONFIG_HOME/isync/mbsyncrc"
alias a="aerc"

# image viewer
alias sxiv="sxiv -b -g 1280x720"
